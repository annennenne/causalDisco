#bnstruct::learn.network with sem
Hybrid learning using the Structural Expectation-Maximization algorithm that combines the MMHC-algorithm with the EM algorithm in order to handle missing information.

----------------------------- -------------------------------------------------------------------------
**Package:**                  bnstruct                                                                 

**Function:**                 learn.network                                                            

**Input:**                    BNDataset (S4)                                                           

**Output:**                   S4 object BN                                                             

**Documentation:**            https://cran.r-project.org/web/packages/bnstruct/vignettes/bnstruct.pdf  

**Article:**                  https://academic.oup.com/bioinformatics/article/33/8/1250/2730229        

**Development repository:**   https://github.com/sambofra/bnstruct                                     
----------------------------- -------------------------------------------------------------------------


- Claims to handle missing information, however it is imputed prior to causal structure learning and thus is not part of the learning procedure.
- Allows for the user to specify restrictions in edge orientation by specifying a hierarchy of the nodes, corresponding to a grouped causal ordering.


*Minimal code example:*

```` {r, eval = FALSE}
#Load categorical dataset catData with missing information
load(url("https://github.com/annennenne/causalDisco/raw/master/data/exampledata_catData_mcar.rda"))

#Load package
library(bnstruct)

#Prepare data for learn.network() call: convert data into bnstruct BNDataset format
##Mandatory arguments:
###A dataset consisting of numbers. It will *not* be treated as numerical, however,
####so using arbitrary numerical values to represent factor level is okay. 
###discreteness: Vector of logicals indicating whether each variable is
####categorical or not. We use TRUE for all. Note that if non-categorical variables
####are supplied, they are discretized before being used further.
###variables: the names of the variables (we use the names from the dataset)
###node.sizes: number of unique levels for each variable. We specify 5 for all of them,
####since they all have 5 levels.
catData_mcar_asNumbers <- as.data.frame(sapply(catData_mcar, as.numeric))
bnstruct_catData_mcar <- BNDataset(catData_mcar_asNumbers, 
                                   discreteness = rep(TRUE, 5),
                                   variables = names(catData_mcar_asNumbers),
                                   node.sizes = rep(5, 5))


#Learn causal structure using learn.network() with "sem" argument:
#Mandatory arguments: 
##The dataset as a BNDataset object
##algo: Which algorithm to use for structure learning. We choose "sem"
###(Structural Expectation-Maximization)
bnstruct_sem_out <- learn.network(bnstruct_catData_mcar, 
                                  algo = "sem")


#Outputted adjacency matrix 
  #Adjacency matrix without variable names
  bnstruct_sem_out_adjM <- bnstruct_sem_out@dag
  
  #Add variable names 
  rownames(bnstruct_sem_out_adjM) <- bnstruct_sem_out@variables
  colnames(bnstruct_sem_out_adjM) <- bnstruct_sem_out@variables
  
  #Look at adjacency matrix with names
  bnstruct_sem_out_adjM

#Plot output
plot(bnstruct_sem_out)

```
