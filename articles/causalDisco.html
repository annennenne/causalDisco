<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>causalDisco • causalDisco</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="causalDisco">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">causalDisco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.5.9049</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/causalDisco.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/causal-discovery.html">Causal Discovery</a></li>
    <li><a class="dropdown-item" href="../articles/knowledge.html">Knowledge</a></li>
    <li><a class="dropdown-item" href="../articles/new-algorithm.html">Extending causalDisco with New Algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/disco-coders/causalDisco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>causalDisco</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/disco-coders/causalDisco/blob/main/vignettes/causalDisco.Rmd" class="external-link"><code>vignettes/causalDisco.Rmd</code></a></small>
      <div class="d-none name"><code>causalDisco.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/disco-coders/causalDisco" class="external-link">causalDisco</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; causalDisco startup:</span></span>
<span><span class="co">#&gt;   Java heap size requested: 2 GB</span></span>
<span><span class="co">#&gt;   Tetrad version: 7.6.10</span></span>
<span><span class="co">#&gt;   Java successfully initialized with 2 GB.</span></span>
<span><span class="co">#&gt;   To change heap size, set options(java.heap.size = 'Ng') or Sys.setenv(JAVA_HEAP_SIZE = 'Ng') *before* loading.</span></span>
<span><span class="co">#&gt;   Restart R to apply changes.</span></span></code></pre></div>
<p>This vignette provides an overview of the causalDisco package, which
offers tools for causal discovery from observational data. It covers the
main features of the package, including various causal discovery
algorithms, knowledge incorporation, and result visualization.</p>
<div class="section level2">
<h2 id="running-causal-discovery-algorithms">Running causal discovery algorithms<a class="anchor" aria-label="anchor" href="#running-causal-discovery-algorithms"></a>
</h2>
<p>We will for this section use the <code>num_data</code> dataset
included in the package for demonstrating how to run causal discovery
algorithms. It contains 5 numerical variables,
<code>X1, X2, X3, Z</code>, and <code>Y</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">num_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">num_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;         X1        X2       X3         Z        Y</span></span>
<span><span class="co">#&gt; 1 3.900715  7.048325 6.964806 10.272479 15.35505</span></span>
<span><span class="co">#&gt; 2 4.736112  6.236746 5.666022 10.357262 23.36749</span></span>
<span><span class="co">#&gt; 3 4.657992 12.169805 9.127046  9.138338 25.32495</span></span>
<span><span class="co">#&gt; 4 5.176469  6.392344 6.101088 10.808335 26.75643</span></span>
<span><span class="co">#&gt; 5 4.535538 10.305236 7.465185 10.612735 22.67612</span></span>
<span><span class="co">#&gt; 6 4.885914 10.018856 7.413312  9.375931 28.03132</span></span></code></pre></div>
<p>To make the different causal graphs easier to interpret, we define a
custom fixed layout for plotting the results:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="st">"X3"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00</span>, <span class="fl">0.50</span>, <span class="fl">0.00</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To run a causal discovery algorithm, we first define the algorithm
using the corresponding function, and then pass it to the
<code><a href="../reference/disco.html">disco()</a></code> function along with the data. Below we demonstrate
this process using the Peter-Clark (PC) algorithm from bnlearn with
Fisher’s Z test:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc_bnlearn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pc.html">pc</a></span><span class="op">(</span></span>
<span>  engine <span class="op">=</span> <span class="st">"bnlearn"</span>, <span class="co"># Use the bnlearn implementation</span></span>
<span>  test <span class="op">=</span> <span class="st">"fisher_z"</span>, <span class="co"># Use Fisher's Z test for conditional independence</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># Significance level for the test</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pc_result_bnlearn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">num_data</span>, method <span class="op">=</span> <span class="va">pc_bnlearn</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize the results using <code><a href="../reference/plot.html">plot()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pc_result_bnlearn</span>, layout <span class="op">=</span> <span class="va">plot_layout</span>, main <span class="op">=</span> <span class="st">"PC Fisher Z (bnlearn)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="causalDisco_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
<p>The first notable feature of this plot is that some edges are
directed, while others are undirected. For example, the edge from
<code>X1</code> to <code>Y</code> is directed, indicating a causal
effect of <code>X1</code> on <code>Y</code>. In contrast, the edge
between <code>X1</code> and <code>X3</code> is undirected, indicating
that the data alone do not provide sufficient information to determine
the causal direction. Both orientations <code>X1 %--&gt;% X3</code> and
<code>X3 %--&gt;% X1</code> are compatible with the observed conditional
independencies.</p>
<p>To view all engines available for a specific algorithm, you can see
the documentation using <code><a href="../reference/pc.html">?pc</a></code>, where all options are listed
under the <code>engine</code> argument. Instead of using bnlearn, we can
also use the PC implementation from the pcalg package with the same
test:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc_pcalg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pc.html">pc</a></span><span class="op">(</span></span>
<span>  engine <span class="op">=</span> <span class="st">"pcalg"</span>, <span class="co"># Use the pcalg implementation</span></span>
<span>  test <span class="op">=</span> <span class="st">"fisher_z"</span>, <span class="co"># Use Fisher's Z test for conditional independence</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># Significance level for the test</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pc_result_pcalg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">num_data</span>, method <span class="op">=</span> <span class="va">pc_pcalg</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">pc_result_pcalg</span>, layout <span class="op">=</span> <span class="va">plot_layout</span>, main <span class="op">=</span> <span class="st">"PC Fisher Z (pcalg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="causalDisco_files/figure-html/pc%20algorithm%20fisher%20z%20pcalg-1.png" class="r-plt" alt="" width="700"></p>
<p>We see that the results using the PC algorithm implemented in bnlearn
and pcalg gives the same output on this dataset.</p>
<p>You can also use a different algorithm altogether, such as the GES
algorithm. It follows the same pattern, however GES is a score-based
algorithm, so instead of a test and an alpha level, we need to specify a
score. Below we will use the Extended Bayesian Information Criterion
(EBIC) score from Tetrad.</p>
<p>Tetrad is written in Java, so to use it we first need to ensure that
Java is installed and that the Tetrad jar files are available. This can
be done using the <code><a href="../reference/check_tetrad_install.html">check_tetrad_install()</a></code> function. If they
aren’t installed, we provide the helper functions
<code><a href="../reference/install_java.html">install_java()</a></code> and <code><a href="../reference/install_tetrad.html">install_tetrad()</a></code> to set
them up.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/check_tetrad_install.html">check_tetrad_install</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">installed</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="../reference/check_tetrad_install.html">check_tetrad_install</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">java_ok</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ges_tetrad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ges.html">ges</a></span><span class="op">(</span></span>
<span>    engine <span class="op">=</span> <span class="st">"tetrad"</span>, <span class="co"># Use the Tetrad implementation</span></span>
<span>    score <span class="op">=</span> <span class="st">"ebic"</span> <span class="co"># Use the EBIC score</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ges_result_tetrad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">num_data</span>, method <span class="op">=</span> <span class="va">ges_tetrad</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">ges_result_tetrad</span>, layout <span class="op">=</span> <span class="va">plot_layout</span>, main <span class="op">=</span> <span class="st">"GES EBIC (Tetrad)"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ges-ebic-tetrad.png"></p>
<p>If you want to customize the plot appearance further, you can pass
additional arguments to <code><a href="../reference/plot.html">plot()</a></code>. For example, to change the
appearance of the nodes, you can use the <code>node_style</code>
argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">pc_result_bnlearn</span>,</span>
<span>  layout <span class="op">=</span> <span class="va">plot_layout</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Customized plot"</span>,</span>
<span>  node_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"lightblue"</span>, <span class="co"># Fill color</span></span>
<span>    col <span class="op">=</span> <span class="st">"darkblue"</span>, <span class="co"># Border color</span></span>
<span>    lwd <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Border width</span></span>
<span>    padding <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Text padding (mm)</span></span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span> <span class="co"># Size multiplier</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="causalDisco_files/figure-html/custom%20plot-1.png" class="r-plt" alt="" width="700"></p>
<p>For more details on customizing plots and generating TikZ code for
LaTeX documents, see the <a href="visualization.html">visualization
vignette</a>.</p>
<p>Instead of using <code><a href="../reference/plot.html">plot()</a></code>, another way to view and analyze
the results is to use the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> or <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
functions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pc_result_bnlearn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">caugi graph</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Graph class: <span style="font-weight: bold;">PDAG</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Edges</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   from  edge  to   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> X1    --&gt;   Y    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> X1    ---   Z    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> X2    ---   X3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> X2    --&gt;   Y    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> X3    --&gt;   Y    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Z     --&gt;   Y</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Nodes</span> ──</span></span>
<span><span class="co">#&gt;   name </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> X1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> X2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> X3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Z    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Y</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Knowledge object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pc_result_bnlearn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">caugi graph summary</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Graph class: <span style="font-weight: bold;">PDAG</span></span></span>
<span><span class="co">#&gt; Nodes: <span style="font-weight: bold;">5</span></span></span>
<span><span class="co">#&gt; Edges: <span style="font-weight: bold;">6</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Knowledge summary</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tiers: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; Variables: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; Required edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; Forbidden edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Variables per Tier</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="incorporating-knowledge">Incorporating knowledge<a class="anchor" aria-label="anchor" href="#incorporating-knowledge"></a>
</h2>
<p>We will for this section use the dataset <code>tpc_example</code>,
which contains variables, which are measured at three different life
stages: childhood, youth, and old age.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tpc_example</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tpc_example</span><span class="op">)</span></span>
<span><span class="co">#&gt;   child_x2   child_x1    youth_x4 youth_x3  oldage_x6  oldage_x5</span></span>
<span><span class="co">#&gt; 1        0 -0.7104066 -0.07355602        1  6.4984994  3.0740123</span></span>
<span><span class="co">#&gt; 2        0  0.2568837 -1.16865142        1  0.3254685  1.9726530</span></span>
<span><span class="co">#&gt; 3        0 -0.2466919 -0.63474826        1  4.1298927  1.9666697</span></span>
<span><span class="co">#&gt; 4        1  1.6524574  0.97115845        0 -7.9064009 -4.5160676</span></span>
<span><span class="co">#&gt; 5        0 -0.9516186  0.67069597        0  1.7089134  0.7903853</span></span>
<span><span class="co">#&gt; 6        1  1.9549723 -0.65054654        0 -6.9758928 -3.2107342</span></span></code></pre></div>
<p>Since we know the temporal ordering of the variables, we can
incorporate this background knowledge into the causal discovery
algorithm. Specifically, we know that variables measured in childhood
cannot be caused by variables measured in youth or old age, and
variables measured in youth cannot be caused by variables measured in
old age.</p>
<p>Knowledge is encoded by creating a <code>knowledge</code> object via
the <code><a href="../reference/knowledge.html">knowledge()</a></code> function. The first argument (optional, but
recommended for name matching) specifies the dataset. Tiered knowledge
can then be defined using the <code>tier()</code> function. Here, we
illustrate this by creating a tiered knowledge structure based on life
stages:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/knowledge.html">knowledge</a></span><span class="op">(</span></span>
<span>  <span class="va">tpc_example</span>,</span>
<span>  <span class="fu">tier</span><span class="op">(</span></span>
<span>    <span class="va">child</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"child_x1"</span>, <span class="st">"child_x2"</span><span class="op">)</span>,</span>
<span>    <span class="va">youth</span> <span class="op">~</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"youth"</span><span class="op">)</span>, <span class="co"># tidyselect helper; equivalent to c("youth_x3", "youth_x4")</span></span>
<span>    <span class="va">oldage</span> <span class="op">~</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"oldage"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For more details on how to define knowledge, see the <a href="knowledge.html">knowledge vignette</a>.</p>
<p>You can view the knowledge object using <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>,
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="../reference/plot.html">plot()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">kn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Knowledge object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Tiers</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">tier</span>  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> oldage</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Variables</span> ──</span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">var</span>       <span style="font-weight: bold;">tier</span>  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child_x1  child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> child_x2  child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> youth_x3  youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> youth_x4  youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> oldage_x5 oldage</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> oldage_x6 oldage</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kn</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Knowledge summary</span> ──</span></span>
<span><span class="co">#&gt; Tiers: <span style="font-weight: bold;">3</span></span></span>
<span><span class="co">#&gt; Variables: <span style="font-weight: bold;">6</span></span></span>
<span><span class="co">#&gt; Required edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; Forbidden edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Variables per Tier</span></span>
<span><span class="co">#&gt; child: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="co">#&gt; oldage: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="co">#&gt; youth: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">kn</span>, main <span class="op">=</span> <span class="st">"Temporal Knowledge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="causalDisco_files/figure-html/view%20knowledge-1.png" class="r-plt" alt="" width="700"></p>
<p>The plot displays vertical tiers, each enclosed in a shaded rectangle
and labeled with the corresponding tier name at the top.</p>
<p>We can then incorporate this knowledge into any algorithm like above.
To do so, you need to pass the <code>knowledge</code> object as an
argument to the <code><a href="../reference/disco.html">disco()</a></code> function. Here we use the Temporal
Peter-Clark (tpc) algorithm from causalDisco with the regression-based
information loss test:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tpc_method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tpc.html">tpc</a></span><span class="op">(</span></span>
<span>  engine <span class="op">=</span> <span class="st">"causalDisco"</span>, <span class="co"># Use the causalDisco implementation</span></span>
<span>  test <span class="op">=</span> <span class="st">"reg"</span> <span class="co"># Use the regression-based information loss test</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tpc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tpc_example</span>, method <span class="op">=</span> <span class="va">tpc_method</span>, knowledge <span class="op">=</span> <span class="va">kn</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, we can view the results using <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>,
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="../reference/plot.html">plot()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tpc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">caugi graph</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Graph class: <span style="font-weight: bold;">PDAG</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Edges</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   from      edge  to       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child_x1  --&gt;   child_x2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> child_x2  --&gt;   oldage_x5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> child_x2  --&gt;   youth_x4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> oldage_x5 ---   oldage_x6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> youth_x3  --&gt;   oldage_x5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> youth_x4  --&gt;   oldage_x6</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Nodes</span> ──</span></span>
<span><span class="co">#&gt;   name     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child_x2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> child_x1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> youth_x4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> youth_x3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> oldage_x6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> oldage_x5</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Knowledge object</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Tiers</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">tier</span>  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> oldage</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Variables</span> ──</span></span>
<span><span class="co">#&gt;   <span style="font-weight: bold;">var</span>       <span style="font-weight: bold;">tier</span>  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> child_x1  child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> child_x2  child </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> youth_x3  youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> youth_x4  youth </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> oldage_x5 oldage</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> oldage_x6 oldage</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tpc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">caugi graph summary</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Graph class: <span style="font-weight: bold;">PDAG</span></span></span>
<span><span class="co">#&gt; Nodes: <span style="font-weight: bold;">6</span></span></span>
<span><span class="co">#&gt; Edges: <span style="font-weight: bold;">6</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Knowledge summary</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tiers: <span style="font-weight: bold;">3</span></span></span>
<span><span class="co">#&gt; Variables: <span style="font-weight: bold;">6</span></span></span>
<span><span class="co">#&gt; Required edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; Forbidden edges: <span style="font-weight: bold;">0</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Variables per Tier</span></span>
<span><span class="co">#&gt; child: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="co">#&gt; oldage: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="co">#&gt; youth: <span style="font-weight: bold;">2</span> variables</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">tpc_result</span>, main <span class="op">=</span> <span class="st">"TPC reg_test with Temporal Knowledge (causalDisco)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="causalDisco_files/figure-html/view%20tpc%20results-1.png" class="r-plt" alt="" width="700"></p>
<p>Like before, the tiered knowledge is reflected in the plot layout,
with variables grouped by life stage. Additionally, you can customize
the plot appearance further by passing additional arguments to
<code><a href="../reference/plot.html">plot()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>For more information about how to incorporate knowledge, see the <a href="knowledge.html">knowledge vignette</a>.</p>
<p>For more information about causal discovery, see the <a href="causal-discovery.html">causal discovery vignette</a>.</p>
<p>For more information about visualization options, see the <a href="visualization.html">visualization vignette</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjarke Hautop Kristensen, Frederik Fabricius-Bjerre, Anne Helby Petersen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
