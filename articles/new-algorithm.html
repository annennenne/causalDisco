<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extending causalDisco with new algorithms • causalDisco</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extending causalDisco with new algorithms">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">causalDisco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/causalDisco.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/causal-discovery.html">Causal Discovery</a></li>
    <li><a class="dropdown-item" href="../articles/knowledge.html">Knowledge</a></li>
    <li><a class="dropdown-item" href="../articles/new-algorithm.html">Extending causalDisco with new algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/disco-coders/causalDisco/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extending causalDisco with new algorithms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/disco-coders/causalDisco/blob/main/vignettes/new-algorithm.Rmd" class="external-link"><code>vignettes/new-algorithm.Rmd</code></a></small>
      <div class="d-none name"><code>new-algorithm.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/disco-coders/causalDisco" class="external-link">causalDisco</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; causalDisco startup:</span></span>
<span><span class="co">#&gt;   Java heap size requested: 2 GB</span></span>
<span><span class="co">#&gt;   Tetrad version: 7.6.10</span></span>
<span><span class="co">#&gt;   Java successfully initialized with 2 GB.</span></span>
<span><span class="co">#&gt;   To change heap size, set options(java.heap.size = 'Ng') or Sys.setenv(JAVA_HEAP_SIZE = 'Ng') *before* loading.</span></span>
<span><span class="co">#&gt;   Restart R to apply changes.</span></span></code></pre></div>
<p>This vignette illustrates how to add a new algorithm to
<code>causalDisco</code> from bnlearn, pcalg and Tetrad. Both bnlearn
and pcalg are R packages and therefore share the same interface, while
Tetrad is a Java library and requires a slightly different integration
pattern.</p>
<div class="section level2">
<h2 id="bnlearn-and-pcalg">bnlearn and pcalg<a class="anchor" aria-label="anchor" href="#bnlearn-and-pcalg"></a>
</h2>
<p>Suppose we want to add the Hybrid Parents and Children (HPC)
algorithm from bnlearn. We can integrate it into causalDisco by creating
a new function <code>hpc()</code>.</p>
<p>HPC is a constraint-based algorithm, so it requires a conditional
independence test and a significance level alpha. It returns a PDAG, so
we set the <code>graph_class</code> attribute to
<code>"PDAG"</code>.</p>
<p>The function takes an <code>engine</code> argument, which specifies
which implementation of the algorithm to use. Even though we only add
HPC from bnlearn in this example, we set up the structure to allow for
multiple engines in the future. The <code>...</code> argument allows us
to pass additional arguments to the underlying algorithm and test.</p>
<p>The code for the <code>hpc()</code> function is as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">engine</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bnlearn"</span><span class="op">)</span>,</span>
<span>  <span class="va">test</span>,</span>
<span>  <span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">engine</span><span class="op">)</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/list2.html" class="external-link">list2</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">builder</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">knowledge</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">runner</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>      <span class="va">engine</span>,</span>
<span>      bnlearn <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/exec.html" class="external-link">exec</a></span><span class="op">(</span></span>
<span>        <span class="va">hpc_bnlearn_runner</span>,</span>
<span>        test <span class="op">=</span> <span class="va">test</span>,</span>
<span>        alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>        <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">args</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">runner</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_disco_method.html">new_disco_method</a></span><span class="op">(</span></span>
<span>    builder <span class="op">=</span> <span class="va">builder</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"hpc"</span>,</span>
<span>    engine <span class="op">=</span> <span class="va">engine</span>,</span>
<span>    graph_class <span class="op">=</span> <span class="st">"PDAG"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">method</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We see that the <code>hpc()</code> function needs two components:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Builder function:</strong> Constructs a <em>runner</em>
for the algorithm. It configures the algorithm with the provided
parameters and optional background knowledge.</p></li>
<li><p><strong>Method object:</strong> Created via
<code><a href="../reference/new_disco_method.html">new_disco_method()</a></code>. It encapsulates the builder and
metadata about the method. This allows us to be able to call
<code><a href="../reference/disco.html">disco()</a></code> to execute the algorithm on a dataset.</p></li>
</ol>
<p>Next, we define the runner. The runner handles configuring the search
object with the chosen test, alpha level, and any additional arguments,
and it actually runs the search on the data when called. For bnlearn
algorithms, we use the <code>BnlearnSearch</code> R6 class to manage
search configuration and execution. We also use
<code><a href="../reference/distribute_engine_args.html">distribute_engine_args()</a></code> to determine which extra arguments
should be passed to the test, the algorithm, or both.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpc_bnlearn_runner</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">test</span>, <span class="va">alpha</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">search</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/BnlearnSearch.html">BnlearnSearch</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">args_to_pass</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribute_engine_args.html">distribute_engine_args</a></span><span class="op">(</span></span>
<span>    search <span class="op">=</span> <span class="va">search</span>,</span>
<span>    args <span class="op">=</span> <span class="va">args</span>,</span>
<span>    engine <span class="op">=</span> <span class="st">"bnlearn"</span>,</span>
<span>    alg <span class="op">=</span> <span class="st">"hpc"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">search</span><span class="op">$</span><span class="fu">set_test</span><span class="op">(</span><span class="va">test</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">search</span><span class="op">$</span><span class="fu">set_alg</span><span class="op">(</span><span class="st">"hpc"</span>, <span class="va">args_to_pass</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">runner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    set_knowledge <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">knowledge</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">search</span><span class="op">$</span><span class="fu">set_knowledge</span><span class="op">(</span><span class="va">knowledge</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    run <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">search</span><span class="op">$</span><span class="fu">run_search</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">runner</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Once defined, the HPC algorithm can be used like any other method in
causalDisco. We first construct the method using <code>hpc()</code>, and
then pass it to <code><a href="../reference/disco.html">disco()</a></code>. Here we demonstrate using the
included <code>tpc_example</code> dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tpc_example</span><span class="op">)</span></span>
<span><span class="va">hpc_bnlearn</span> <span class="op">&lt;-</span> <span class="fu">hpc</span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"bnlearn"</span>, test <span class="op">=</span> <span class="st">"fisher_z"</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">hpc_bnlearn_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span><span class="va">tpc_example</span>, <span class="va">hpc_bnlearn</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">hpc_bnlearn_result</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-algorithm_files/figure-html/hpc%20example-1.png" class="r-plt" alt="" width="700"></p>
<p>To implement a <strong>score-based</strong> algorithm instead, the
structure would remain the same. The main difference is that the method
would accept a <code>score</code> argument rather than <code>test</code>
and <code>alpha</code>, and the runner would call
<code>search$set_score()</code> instead of
<code>search$set_test()</code>. A <strong>hybrid</strong> algorithm
algorithm would accept <code>test</code>, <code>alpha</code>, and
<code>score</code> arguments, and the runner would call both
<code>set_test()</code> and <code>set_score()</code>.</p>
<p>To implement an algorithm from pcalg rather than bnlearn, we would
follow the same structure but use the R6 class <code>PcalgSearch</code>
instead of <code>BnlearnSearch</code> in the runner (i.e.,
<code>PcalgSearch$new()</code>).</p>
</div>
<div class="section level2">
<h2 id="tetrad">Tetrad<a class="anchor" aria-label="anchor" href="#tetrad"></a>
</h2>
<p>We will illustrate how to make a custom version (which actually does
the same as our implementation, just with some defensive programming
omitted) of the Boss algorithm from Tetrad. Tetrad algorithms follow a
slightly different integration pattern because Tetrad is a Java library
rather than an R package.</p>
<p>To add a new Tetrad algorithm, first register it with
<code><a href="../reference/register_tetrad_algorithm.html">register_tetrad_algorithm()</a></code>. This function requires:</p>
<ul>
<li>The algorithm name.</li>
<li>A setup function that configures a <code>TetradSearch</code> object
to execute the algorithm.</li>
</ul>
<p>The setup function receives the TetradSearch object as its first
argument, along with any additional parameters passed via
<code>...</code> when the method is constructed. Its responsibilities
are to:</p>
<ol style="list-style-type: decimal">
<li>Configure the TetradSearch object with the appropriate parameters
and score.</li>
<li>Instantiate the correct Tetrad algorithm class.</li>
</ol>
<p>The fully qualified class name can be identified by inspecting the
Tetrad source code at:</p>
<p><a href="https://github.com/cmu-phil/tetrad" class="external-link uri">https://github.com/cmu-phil/tetrad</a></p>
<p>Be sure to browse the version corresponding to the installed Tetrad
release. The relevant Java classes are located under:</p>
<p><a href="https://github.com/cmu-phil/tetrad/tree/development/tetrad-lib/src/main/java" class="external-link uri">https://github.com/cmu-phil/tetrad/tree/development/tetrad-lib/src/main/java</a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/register_tetrad_algorithm.html">register_tetrad_algorithm</a></span><span class="op">(</span></span>
<span>  <span class="st">"my_boss_variant"</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">self</span>,</span>
<span>    <span class="va">num_starts</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">use_bes</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">use_data_order</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">output_cpdag</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="fu">set_params</span><span class="op">(</span></span>
<span>      USE_BES <span class="op">=</span> <span class="va">use_bes</span>,</span>
<span>      NUM_STARTS <span class="op">=</span> <span class="va">num_starts</span>,</span>
<span>      USE_DATA_ORDER <span class="op">=</span> <span class="va">use_data_order</span>,</span>
<span>      OUTPUT_CPDAG <span class="op">=</span> <span class="va">output_cpdag</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">alg</span> <span class="op">&lt;-</span> <span class="fu">rJava</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rJava/man/jnew.html" class="external-link">.jnew</a></span><span class="op">(</span></span>
<span>      <span class="st">"edu/cmu/tetrad/algcomparison/algorithm/oracle/cpdag/Boss"</span>,</span>
<span>      <span class="va">self</span><span class="op">$</span><span class="va">score</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">alg</span><span class="op">$</span><span class="fu">setKnowledge</span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">knowledge</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can view all the custom registered Tetrad algorithms using
<code>tetrad_alg_registry()</code>, and reset it using
<code><a href="../reference/reset_tetrad_alg_registry.html">reset_tetrad_alg_registry()</a></code>.</p>
<p>Like for bnlearn and pcalg, we then create a method function
<code>my_boss_variant()</code> that constructs a builder function which
in turn constructs a runner using the registered Tetrad algorithm.</p>
<p>BOSS is a <strong>score-based</strong> algorithm, so the method
accepts a <code>score</code> argument and passes it to the runner, which
configures the <code>TetradSearch</code> object accordingly. It returns
a PDAG, so we set the <code>graph_class</code> attribute to
<code>"PDAG"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_boss_variant</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">engine</span> <span class="op">=</span> <span class="st">"tetrad"</span>,</span>
<span>  <span class="va">score</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">engine</span><span class="op">)</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/list2.html" class="external-link">list2</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">builder</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">knowledge</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">runner</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>      <span class="va">engine</span>,</span>
<span>      tetrad <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/exec.html" class="external-link">exec</a></span><span class="op">(</span><span class="va">my_boss_variant_tetrad_runner</span>, <span class="va">score</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">args</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">runner</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_disco_method.html">new_disco_method</a></span><span class="op">(</span></span>
<span>    builder <span class="op">=</span> <span class="va">builder</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"my_boss_variant"</span>,</span>
<span>    engine <span class="op">=</span> <span class="va">engine</span>,</span>
<span>    graph_class <span class="op">=</span> <span class="st">"PDAG"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">method</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next we define the runner function
<code>my_boss_variant_tetrad_runner()</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_boss_variant_tetrad_runner</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">score</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">search</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/TetradSearch.html">TetradSearch</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">args_to_pass</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distribute_engine_args.html">distribute_engine_args</a></span><span class="op">(</span></span>
<span>    search <span class="op">=</span> <span class="va">search</span>,</span>
<span>    args <span class="op">=</span> <span class="va">args</span>,</span>
<span>    engine <span class="op">=</span> <span class="st">"tetrad"</span>,</span>
<span>    alg <span class="op">=</span> <span class="st">"my_boss_variant"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">args_to_pass</span><span class="op">$</span><span class="va">score_args</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/exec.html" class="external-link">exec</a></span><span class="op">(</span><span class="va">search</span><span class="op">$</span><span class="va">set_score</span>, <span class="va">score</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">args_to_pass</span><span class="op">$</span><span class="va">score_args</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">search</span><span class="op">$</span><span class="fu">set_score</span><span class="op">(</span><span class="va">score</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">args_to_pass</span><span class="op">$</span><span class="va">alg_args</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/exec.html" class="external-link">exec</a></span><span class="op">(</span><span class="va">search</span><span class="op">$</span><span class="va">set_alg</span>, <span class="st">"my_boss_variant"</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">args_to_pass</span><span class="op">$</span><span class="va">alg_args</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">search</span><span class="op">$</span><span class="fu">set_alg</span><span class="op">(</span><span class="st">"my_boss_variant"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">runner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    set_knowledge <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">knowledge</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">search</span><span class="op">$</span><span class="fu">set_knowledge</span><span class="op">(</span><span class="va">knowledge</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    run <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">search</span><span class="op">$</span><span class="fu">run_search</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">runner</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Once defined we can now run <code>my_boss_variant()</code> like any
other method in causalDisco.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure Tetrad is installed and Java is working before running the algorithm</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/verify_tetrad.html">verify_tetrad</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">installed</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="../reference/verify_tetrad.html">verify_tetrad</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">java_ok</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">my_boss_variant_tetrad</span> <span class="op">&lt;-</span> <span class="fu">my_boss_variant</span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"tetrad"</span>, score <span class="op">=</span> <span class="st">"sem_bic"</span><span class="op">)</span></span>
<span>  <span class="va">my_boss_variant_tetrad_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/disco.html">disco</a></span><span class="op">(</span><span class="va">tpc_example</span>, <span class="va">my_boss_variant_tetrad</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">my_boss_variant_tetrad_result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="ges-ebic-tetrad-pkgdown.png"><!-- --></p>
<p>Once again, if using a hybrid or constraint-based algorithm rather
than a score-based one, the structure would remain the same but the
method would accept different arguments (e.g., <code>test</code> and
<code>alpha</code> for a constraint-based algorithm).</p>
<p>Finally, we clean up the custom registered Tetrad algorithm</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reset_tetrad_alg_registry.html">reset_tetrad_alg_registry</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this vignette, we have illustrated how to add new algorithms to
causalDisco, both from the R packages pcalg and bnlearn and from
Tetrad.</p>
<p>If you have any feedback or suggestions for improvement on the API
and functionality for extending causalDisco, please let us know by
opening an issue on GitHub.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjarke Hautop Kristensen, Frederik Fabricius-Bjerre, Anne Helby Petersen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
