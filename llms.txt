# causalDisco

causalDisco provides a unified interface for causal discovery on
observational data. It wraps multiple causal discovery backends under a
common, consistent syntax.

## Motivation

Causal discovery methods exist in many ecosystems, for example in
bnlearn, pcalg, or Tetrad, but their APIs vary widely.

causalDisco unifies them under one clear grammar, making it easy to
compare results, switch algorithms, and focus on scientific questions
rather than package quirks.

Time to hit the disco ðŸª©

## Installation

### Install causalDisco

To install causalDisco ensure you first have installed Rust as described
below.

Then you can install the stable version of causalDisco from CRAN with

``` r
install.packages("causalDisco")
```

or with suggested dependencies (for Tetrad integration) using

``` r
install.packages("causalDisco", dependencies = TRUE)
```

or the development version of causalDisco from GitHub using pak:

``` r
pak::pkg_install("disco-coders/causalDisco", dependencies = TRUE)
```

### Installing Rust

causalDisco depends on the package
[caugi](https://github.com/frederikfabriciusbjerre/caugi), which
requires Rust to be installed on your system. See
<https://rust-lang.org/tools/install/> for instructions on how to
install Rust.

### Installing Java / JDK

causalDisco provides an interface to the Java library
[Tetrad](https://github.com/cmu-phil/tetrad) for causal discovery
algorithms. To use algorithms from Tetrad you need to install a Java
Development Kit (JDK) \>= 21. We recommend Eclipse Temurin (OpenJDK),
available at <https://adoptium.net> for all major operating systems.

Alternatively, we provide a helper function to install Temurin JDK 25 on
macOS and Windows:

``` r
causalDisco::install_java()
```

The current supported version of Tetrad can then be installed by calling

``` r
causalDisco::install_tetrad()
```

To verify everything is set up correctly you can run
[`verify_tetrad()`](https://disco-coders.github.io/causalDisco/reference/verify_tetrad.md):

``` r
causalDisco::verify_tetrad()
#> $installed
#> [1] TRUE
#> 
#> $version
#> [1] "7.6.10"
#> 
#> $java_ok
#> [1] TRUE
#> 
#> $java_version
#> [1] "25.0.2"
#> 
#> $message
#> [1] "Tetrad found (version 7.6.10). Java version 25.0.2 is OK."
```

## Example

With causalDisco you can currently run causal discovery algorithms from
the package causalDisco itself, the the R packages bnlearn and pcalg,
and the Java library Tetrad with a consistent syntax. Here we provide a
simple example of how to use these different backends with the same code
structure. We also show how to incorporate tiered background knowledge.

``` r
library(causalDisco)
#> causalDisco startup:
#>   Java heap size requested: 2 GB
#>   Tetrad version: 7.6.10
#>   Java successfully initialized with 2 GB.
#>   To change heap size, set options(java.heap.size = 'Ng') or Sys.setenv(JAVA_HEAP_SIZE = 'Ng') *before* loading.
#>   Restart R to apply changes.

# Load data
data(tpc_example)

pcalg_ges <- ges(
  engine = "pcalg", # Use the pcalg implementation
  score = "sem_bic" # Use BIC score for the GES algorithm
)
disco_pcalg_ges <- disco(data = tpc_example, method = pcalg_ges)

# We can also pass background knowledge to the engines that support it. Here we use tiered knowledge,
# which is a common way to encode temporal ordering of variables.
kn <- knowledge(
  tpc_example,
  tier(
    child ~ starts_with("child"), # Using the tidyselect syntax to select variables for each tier
    youth ~ starts_with("youth"),
    old ~ starts_with("old")
  )
)

cd_tpc <- tpc(
  engine = "causalDisco", # Use the causalDisco implementation
  test = "fisher_z", # Use Fisher's Z test for conditional independence
  alpha = 0.05 # Significance level for the test
)
disco_cd_tpc <- disco(data = tpc_example, method = cd_tpc, knowledge = kn)

bnlearn_pc <- pc(
  engine = "bnlearn", # Use the bnlearn implementation
  test = "cor", # Use Pearson correlation test for conditional independence
  alpha = 0.05
)
disco_bnlearn_pc <- disco(data = tpc_example, method = bnlearn_pc, knowledge = kn)

# Requires Tetrad to be installed
if (verify_tetrad()$installed && verify_tetrad()$java_ok) {
  tetrad_pc <- pc(
    engine = "tetrad", # Use the Tetrad implementation
    test = "conditional_gaussian", # Use conditional Gaussian test
    alpha = 0.05
  )
  disco_tetrad_pc <- disco(data = tpc_example, method = tetrad_pc, knowledge = kn)
}
```

You can visualize the resulting causal graph using the
[`plot()`](https://disco-coders.github.io/causalDisco/reference/plot.md)
function:

``` r
plot(disco_cd_tpc)
```

![A causal graph with the known tiers indicated by vertical positioning
of the nodes.](reference/figures/README-plot-1.png)

Please see the package vignettes for more detailed introductions to the
package and its features, such as how to incorporate knowledge, run
causal discovery, and visualize results.

## Bugs & requests

Bug reports and feature requests are welcome:

[open an issue](https://github.com/disco-coders/causalDisco/issues).

# Package index

## Overview

Package overview

- [`causalDisco`](https://disco-coders.github.io/causalDisco/reference/causalDisco-package.md)
  [`causalDisco-package`](https://disco-coders.github.io/causalDisco/reference/causalDisco-package.md)
  : causalDisco: Causal Discovery in R

## Causal Discovery Interface

High-level interface for running causal discovery.

- [`disco()`](https://disco-coders.github.io/causalDisco/reference/disco.md)
  : Perform Causal Discovery
- [`knowledge()`](https://disco-coders.github.io/causalDisco/reference/knowledge.md)
  : Knowledge Mini-DSL Constructor

## Causal Discovery Algorithms

Core search algorithms implemented or wrapped by causalDisco.

- [`boss()`](https://disco-coders.github.io/causalDisco/reference/boss.md)
  : BOSS Algorithm for Causal Discovery
- [`boss_fci()`](https://disco-coders.github.io/causalDisco/reference/boss_fci.md)
  : BOSS-FCI Algorithm for Causal Discovery
- [`fci()`](https://disco-coders.github.io/causalDisco/reference/fci.md)
  : FCI Algorithm for Causal Discovery
- [`ges()`](https://disco-coders.github.io/causalDisco/reference/ges.md)
  : GES Algorithm for Causal Discovery
- [`gfci()`](https://disco-coders.github.io/causalDisco/reference/gfci.md)
  : GFCI Algorithm for Causal Discovery
- [`grasp()`](https://disco-coders.github.io/causalDisco/reference/grasp.md)
  : GRaSP Algorithm for Causal Discovery
- [`grasp_fci()`](https://disco-coders.github.io/causalDisco/reference/grasp_fci.md)
  : GRaSP-FCI Algorithm for Causal Discovery
- [`gs()`](https://disco-coders.github.io/causalDisco/reference/gs.md) :
  GS Algorithm for Causal Discovery
- [`iamb()`](https://disco-coders.github.io/causalDisco/reference/iamb-family.md)
  [`iamb_fdr()`](https://disco-coders.github.io/causalDisco/reference/iamb-family.md)
  [`fast_iamb()`](https://disco-coders.github.io/causalDisco/reference/iamb-family.md)
  [`inter_iamb()`](https://disco-coders.github.io/causalDisco/reference/iamb-family.md)
  : IAMB Family of Causal Discovery Algorithms
- [`pc()`](https://disco-coders.github.io/causalDisco/reference/pc.md) :
  PC Algorithm for Causal Discovery
- [`sp_fci()`](https://disco-coders.github.io/causalDisco/reference/sp_fci.md)
  : SP-FCI Algorithm for Causal Discovery
- [`tfci()`](https://disco-coders.github.io/causalDisco/reference/tfci.md)
  : TFCI Algorithm for Causal Discovery
- [`tges()`](https://disco-coders.github.io/causalDisco/reference/tges.md)
  : TGES Algorithm for Causal Discovery
- [`tpc()`](https://disco-coders.github.io/causalDisco/reference/tpc.md)
  : TPC Algorithm for Causal Discovery

## R6 Classes

- [`BnlearnSearch`](https://disco-coders.github.io/causalDisco/reference/BnlearnSearch.md)
  : R6 Interface to bnlearn Search Algorithms
- [`CausalDiscoSearch`](https://disco-coders.github.io/causalDisco/reference/CausalDiscoSearch.md)
  : R6 Interface to causalDisco Search Algorithms
- [`PcalgSearch`](https://disco-coders.github.io/causalDisco/reference/PcalgSearch.md)
  : R6 Interface to pcalg Search Algorithms
- [`TetradSearch`](https://disco-coders.github.io/causalDisco/reference/TetradSearch.md)
  : R6 Interface to Tetrad Search Algorithms

## Setup for Tetrad Engine

Functions for installing and verifying the Tetrad Java backend.

- [`install_java()`](https://disco-coders.github.io/causalDisco/reference/install_java.md)
  : Install Eclipse Temurin JDK 25
- [`install_tetrad()`](https://disco-coders.github.io/causalDisco/reference/install_tetrad.md)
  : Install Tetrad GUI
- [`verify_tetrad()`](https://disco-coders.github.io/causalDisco/reference/verify_tetrad.md)
  : Check Tetrad Installation

## causalDisco Algorithm Run Functions

Low-level functions that execute causalDisco search algorithms and
detail their parameters.

- [`tfci_run()`](https://disco-coders.github.io/causalDisco/reference/tfci_run.md)
  : Run the TFCI Algorithm for Causal Discovery
- [`tges_run()`](https://disco-coders.github.io/causalDisco/reference/tges_run.md)
  : Run the TGES Algorithm for Causal Discovery
- [`tpc_run()`](https://disco-coders.github.io/causalDisco/reference/tpc_run.md)
  : Run the TPC Algorithm for Causal Discovery

## Tests for TPC

Test functions implemented for use in the TPC algorithm.

- [`cor_test()`](https://disco-coders.github.io/causalDisco/reference/cor_test.md)
  : Test for Vanishing Partial Correlations
- [`reg_test()`](https://disco-coders.github.io/causalDisco/reference/reg_test.md)
  : Regression-based Information Loss Test

## Simulation

- [`generate_dag_data()`](https://disco-coders.github.io/causalDisco/reference/generate_dag_data.md)
  : Generate Synthetic Data from a Linear Gaussian DAG
- [`sim_dag()`](https://disco-coders.github.io/causalDisco/reference/sim_dag.md)
  : Simulate a Random DAG

## Example Datasets

Small simulated datasets to illustrate causalDisco workflows.

- [`cat_data`](https://disco-coders.github.io/causalDisco/reference/cat_data.md)
  : Simulated Categorical Data
- [`cat_data_mcar`](https://disco-coders.github.io/causalDisco/reference/cat_data_mcar.md)
  : Simulated Categorical Data with MCAR
- [`cat_ord_data`](https://disco-coders.github.io/causalDisco/reference/cat_ord_data.md)
  : Simulated Ordered Categorical Data
- [`mix_data`](https://disco-coders.github.io/causalDisco/reference/mix_data.md)
  : Simulated Mixed Data
- [`num_data`](https://disco-coders.github.io/causalDisco/reference/num_data.md)
  : Simulated Numerical Data
- [`num_data_latent`](https://disco-coders.github.io/causalDisco/reference/num_data_latent.md)
  : Simulated Numerical Data with Latent Variable
- [`tpc_example`](https://disco-coders.github.io/causalDisco/reference/tpc_example.md)
  : Simulated Life-Course Data

## Printing, Summarizing, and Plotting Objects

- [`print(`*`<knowledge>`*`)`](https://disco-coders.github.io/causalDisco/reference/print.knowledge.md)
  : Print a Knowledge Object
- [`print(`*`<knowledgeable_caugi>`*`)`](https://disco-coders.github.io/causalDisco/reference/print.knowledgeable_caugi.md)
  : Print a Knowledgeable Caugi Object
- [`summary(`*`<knowledge>`*`)`](https://disco-coders.github.io/causalDisco/reference/summary.knowledge.md)
  : Summarize a Knowledge Object
- [`summary(`*`<knowledgeable_caugi>`*`)`](https://disco-coders.github.io/causalDisco/reference/summary.knowledgeable_caugi.md)
  : Summarize a Knowledgeable Caugi Object
- [`plot`](https://disco-coders.github.io/causalDisco/reference/plot.md)
  : Plot Method for causalDisco Objects
- [`plot(`*`<knowledge>`*`)`](https://disco-coders.github.io/causalDisco/reference/plot.knowledge.md)
  : Plot a Knowledge Object
- [`plot(`*`<knowledgeable_caugi>`*`)`](https://disco-coders.github.io/causalDisco/reference/plot.knowledgeable_caugi.md)
  : Plot a Knowledgeable Caugi Object
- [`make_tikz()`](https://disco-coders.github.io/causalDisco/reference/make_tikz.md)
  : Generate TikZ Code from a Object

## Graph Metrics

- [`confusion()`](https://disco-coders.github.io/causalDisco/reference/confusion.md)
  : Confusion Matrix
- [`evaluate()`](https://disco-coders.github.io/causalDisco/reference/evaluate.md)
  : Evaluate Causal Graph Estimates
- [`f1_score()`](https://disco-coders.github.io/causalDisco/reference/f1_score.md)
  : F1 score
- [`false_omission_rate()`](https://disco-coders.github.io/causalDisco/reference/false_omission_rate.md)
  : False Omission Rate
- [`fdr()`](https://disco-coders.github.io/causalDisco/reference/fdr.md)
  : False Discovery Rate
- [`g1_score()`](https://disco-coders.github.io/causalDisco/reference/g1_score.md)
  : G1 score
- [`npv()`](https://disco-coders.github.io/causalDisco/reference/npv.md)
  : Negative Predictive Value
- [`precision()`](https://disco-coders.github.io/causalDisco/reference/precision.md)
  : Precision
- [`recall()`](https://disco-coders.github.io/causalDisco/reference/recall.md)
  : Recall
- [`specificity()`](https://disco-coders.github.io/causalDisco/reference/specificity.md)
  : Specificity
- [`reexports`](https://disco-coders.github.io/causalDisco/reference/reexports.md)
  [`shd`](https://disco-coders.github.io/causalDisco/reference/reexports.md)
  [`hd`](https://disco-coders.github.io/causalDisco/reference/reexports.md)
  [`aid`](https://disco-coders.github.io/causalDisco/reference/reexports.md)
  : Objects exported from other packages

## Knowledge helpers

- [`add_exogenous()`](https://disco-coders.github.io/causalDisco/reference/add_exogenous.md)
  [`add_exo()`](https://disco-coders.github.io/causalDisco/reference/add_exogenous.md)
  : Add Exogenous Variables to Knowledge
- [`add_tier()`](https://disco-coders.github.io/causalDisco/reference/add_tier.md)
  : Add a Tier to Knowledge
- [`add_to_tier()`](https://disco-coders.github.io/causalDisco/reference/add_to_tier.md)
  : Add Variables to a Tier in Knowledge
- [`add_vars()`](https://disco-coders.github.io/causalDisco/reference/add_vars.md)
  : Add Variables to Knowledge
- [`remove_edge()`](https://disco-coders.github.io/causalDisco/reference/remove_edge.md)
  : Remove an Edge from Knowledge
- [`remove_tiers()`](https://disco-coders.github.io/causalDisco/reference/remove_tiers.md)
  : Remove Tiers from Knowledge
- [`remove_vars()`](https://disco-coders.github.io/causalDisco/reference/remove_vars.md)
  : Remove Variables Along with Their Edges from Knowledge
- [`require_edge()`](https://disco-coders.github.io/causalDisco/reference/require_edge.md)
  : Add Required Edges to Knowledge
- [`forbid_edge()`](https://disco-coders.github.io/causalDisco/reference/forbid_edge.md)
  : Add Forbidden Edges to Knowledge
- [`get_tiers()`](https://disco-coders.github.io/causalDisco/reference/get_tiers.md)
  : Get Tiers from Knowledge
- [`reorder_tiers()`](https://disco-coders.github.io/causalDisco/reference/reorder_tiers.md)
  : Reorder Tiers in Knowledge
- [`seq_tiers()`](https://disco-coders.github.io/causalDisco/reference/seq_tiers.md)
  : Generate a Bundle of Tierâ€“Variable Formulas
- [`reposition_tier()`](https://disco-coders.github.io/causalDisco/reference/reposition_tier.md)
  : Move a Tier Relative to Another in Knowledge
- [`convert_tiers_to_forbidden()`](https://disco-coders.github.io/causalDisco/reference/convert_tiers_to_forbidden.md)
  : Convert Tiered Knowledge to Forbidden Knowledge
- [`set_knowledge()`](https://disco-coders.github.io/causalDisco/reference/set_knowledge.md)
  : Set Background Knowledge to Disco Method
- [`as_tetrad_knowledge()`](https://disco-coders.github.io/causalDisco/reference/as_tetrad_knowledge.md)
  : Convert Knowledge to Tetrad Knowledge
- [`as_bnlearn_knowledge()`](https://disco-coders.github.io/causalDisco/reference/as_bnlearn_knowledge.md)
  : Convert Knowledge to bnlearn Knowledge
- [`as_pcalg_constraints()`](https://disco-coders.github.io/causalDisco/reference/as_pcalg_constraints.md)
  : Convert Knowledge to pcalg Knowledge
- [`knowledge_to_caugi()`](https://disco-coders.github.io/causalDisco/reference/knowledge_to_caugi.md)
  : Convert Knowledge to Caugi
- [`knowledgeable_caugi()`](https://disco-coders.github.io/causalDisco/reference/knowledgeable_caugi.md)
  : Knowledgeable Caugi Object
- [`new_knowledgeable_caugi()`](https://disco-coders.github.io/causalDisco/reference/new_knowledgeable_caugi.md)
  : Create a Knowledgeable Caugi Object
- [`deparse_knowledge()`](https://disco-coders.github.io/causalDisco/reference/deparse_knowledge.md)
  : Deparse a Knowledge Object into Knowledge DSL Code
- [`unfreeze()`](https://disco-coders.github.io/causalDisco/reference/unfreeze.md)
  : Unfreeze a Knowledge Object.
- [`` `+`( ``*`<knowledge>`*`)`](https://disco-coders.github.io/causalDisco/reference/plus-.knowledge.md)
  : Merge Knowledge Objects
- [`knowledge.knowledgeable_caugi()`](https://disco-coders.github.io/causalDisco/reference/knowledge.knowledgeable_caugi.md)
  : Extract Knowledge from a Knowledgeable Caugi

## Extend causalDisco

Functions for extending causalDisco with new algorithms from the
available engines.

- [`distribute_engine_args()`](https://disco-coders.github.io/causalDisco/reference/distribute_engine_args.md)
  : Distribute and Validate Engine Arguments
- [`new_disco_method()`](https://disco-coders.github.io/causalDisco/reference/new_disco_method.md)
  : Add a New causalDisco Method
- [`register_tetrad_algorithm()`](https://disco-coders.github.io/causalDisco/reference/register_tetrad_algorithm.md)
  : Register a New Tetrad Algorithm
- [`reset_tetrad_alg_registry()`](https://disco-coders.github.io/causalDisco/reference/reset_tetrad_alg_registry.md)
  : Reset the Tetrad Algorithm Registry

# Articles

### All vignettes

- [Causal
  Discovery](https://disco-coders.github.io/causalDisco/articles/causal-discovery.md):
- [causalDisco](https://disco-coders.github.io/causalDisco/articles/causalDisco.md):
- [Knowledge](https://disco-coders.github.io/causalDisco/articles/knowledge.md):
- [Extending causalDisco with New
  Algorithms](https://disco-coders.github.io/causalDisco/articles/new-algorithm.md):
- [Visualization](https://disco-coders.github.io/causalDisco/articles/visualization.md):
