# R6 Interface to bnlearn Search Algorithms

A wrapper that lets you drive `bnlearns`’s structure-learning algorithms
within the `causalDisco` framework.

## Value

An R6 object with the methods documented below.

## Public fields

- `data`:

  A `data.frame` holding the data set currently attached to the search
  object. Can be set with `set_data()`.

- `score`:

  Character scalar naming the score function used in bnlearn. Can be set
  with `$set_score()`. Kebab-case score names (as used in bnlearn, e.g.
  `"pred-loglik"`) are also accepted and automatically translated to
  snake_case. Recognised values are:

  **Discrete – categorical**

  - `"loglik"` - log-likelihood

  - `"aic"` - Akaike Information Criterion

  - `"bic"` - Bayesian Information Criterion

  - `"ebic"` - Extended BIC

  - `"pred_loglik"` - predictive log-likelihood

  - `"bde"` - Bayesian Dirichlet equivalent (uniform)

  - `"bds"` - Bayesian Dirichlet score

  - `"mbde"` - modified BDE

  - `"bdla"` - locally averaged BDE

  - `"k2"` - K2 score

  - `"fnml"` - factorised NML

  - `"qnml"` - quotient NML

  - `"nal"` - node-average log-likelihood

  - `"pnal"` - penalised node-average log-likelihood

  **Gaussian**

  - `"loglik_g"`, `"aic_g"`, `"bic_g"`, `"ebic_g"`, `"pred_loglik_g"`

  - `"bge"` - Gaussian posterior density

  - `"nal_g"` - node-average log-likelihood

  - `"pnal_g"` - penalised node-average log-likelihood

  **Conditional Gaussian**

  - `"loglik_cg"`, `"aic_cg"`, `"bic_cg"`, `"ebic_cg"`,
    `"pred_loglik_cg"`, `"nal_cg"`, `"pnal_cg"`

- `test`:

  Character scalar naming the conditional-independence test passed to
  bnlearn. Can be set with `$set_score()`. Kebab-case test names (as
  used in bnlearn, e.g. "mi-adf") are also accepted and automatically
  translated to snake_case. Recognised values are:

  **Discrete – categorical**

  - `"mi"` – mutual information

  - `"mi_adf"` – mutual information with adjusted d.f.

  - `"mc_mi"` – Monte Carlo mutual information

  - `"smc_mi"` – sequential Monte Carlo mutual information

  - `"sp_mi"` – semi-parametric mutual information

  - `"mi_sh"` – mutual information (shrinkage)

  - `"x2"` – chi-squared

  - `"x2_adf"` – chi-squared with adjusted d.f.

  - `"mc_x2"` – Monte Carlo chi-squared

  - `"smc_x2"` – sequential Monte Carlo chi-squared

  - `"sp_x2"` – semi-parametric chi-squared

  **Discrete – ordered factors**

  - `"jt"` – Jonckheere–Terpstra

  - `"mc_jt"` – Monte Carlo Jonckheere–Terpstra

  - `"smc_jt"` – sequential Monte Carlo Jonckheere–Terpstra

  **Gaussian**

  - `"cor"` – Pearson correlation

  - `"mc_cor"` – Monte Carlo Pearson correlation

  - `"smc_cor"` – sequential Monte Carlo Pearson correlation

  - `"zf"` / `"fisher_z"` – Fisher Z test

  - `"mc_zf"` – Monte Carlo Fisher Z

  - `"smc_zf"` – sequential Monte Carlo Fisher Z

  - `"mi_g"` – mutual information (Gaussian)

  - `"mc_mi_g"` – Monte Carlo mutual information (Gaussian)

  - `"smc_mi_g"` – sequential Monte Carlo mutual information (Gaussian)

  - `"mi_g_sh"` – mutual information (Gaussian, shrinkage)

  **Conditional Gaussian**

  - `"mi_cg"` – mutual information (conditional Gaussian)

- `alg`:

  Function generated by `$set_alg()` that runs a structure-learning
  algorithm from bnlearn. Recognised values are:

  **Constraint-based**

  - `"pc"` – PC-stable algorithm

  - `"gs"` – Grow-Shrink

  - `"iamb"` – Incremental Association Markov Blanket

  - `"fast.iamb"` – Fast-IAMB

  - `"inter.iamb"` – Interleaved-IAMB

  - `"iamb.fdr"` – IAMB with FDR control

  **Local / skeleton discovery**

  - `"mmpc"` – Max–Min Parents and Children

  - `"si.hiton.pc"` – Semi-Interleaved HITON-PC

  - `"hpc"` – Hybrid Parents and Children

  **Score-based**

  - `"hc"` – Hill-Climbing

  - `"tabu"` – Tabu search

  **Hybrid**

  - `"mmhc"` – Max–Min Hill-Climbing

  - `"rsmax2"` – Restricted Maximisation (two-stage)

  - `"h2pc"` – Hybrid HPC–PC

  **Pairwise mutual-information learners**

  - `"chow.liu"` – Chow–Liu tree

  - `"aracne"` – ARACNE network

- `params`:

  A list of extra tuning parameters stored by `set_params()` and spliced
  into the learner call.

- `knowledge`:

  A list with elements `whitelist` and `blacklist` containing
  prior-knowledge constraints added via
  [`set_knowledge()`](https://bjarkehautop.github.io/causalDisco/reference/set_knowledge.md).

## Methods

### Public methods

- [`BnlearnSearch$new()`](#method-BnlearnSearch-new)

- [`BnlearnSearch$set_params()`](#method-BnlearnSearch-set_params)

- [`BnlearnSearch$set_data()`](#method-BnlearnSearch-set_data)

- [`BnlearnSearch$set_test()`](#method-BnlearnSearch-set_test)

- [`BnlearnSearch$set_score()`](#method-BnlearnSearch-set_score)

- [`BnlearnSearch$set_alg()`](#method-BnlearnSearch-set_alg)

- [`BnlearnSearch$set_knowledge()`](#method-BnlearnSearch-set_knowledge)

- [`BnlearnSearch$run_search()`](#method-BnlearnSearch-run_search)

- [`BnlearnSearch$clone()`](#method-BnlearnSearch-clone)

------------------------------------------------------------------------

### Method `new()`

Constructor for the `BnlearnSearch` class.

#### Usage

    BnlearnSearch$new()

------------------------------------------------------------------------

### Method `set_params()`

Set the parameters for the search algorithm.

#### Usage

    BnlearnSearch$set_params(params)

#### Arguments

- `params`:

  A parameter to set.

------------------------------------------------------------------------

### Method `set_data()`

Set the data for the search algorithm.

#### Usage

    BnlearnSearch$set_data(data)

#### Arguments

- `data`:

  A data frame containing the data to use for the search.

------------------------------------------------------------------------

### Method `set_test()`

Set the conditional-independence test to use in the search algorithm.

#### Usage

    BnlearnSearch$set_test(method, alpha = 0.05)

#### Arguments

- `method`:

  Character naming the test to use.

- `alpha`:

  Significance level for the test.

------------------------------------------------------------------------

### Method `set_score()`

Set the score function for the search algorithm.

#### Usage

    BnlearnSearch$set_score(method)

#### Arguments

- `method`:

  Character naming the score function to use.

------------------------------------------------------------------------

### Method `set_alg()`

Set the causal discovery algorithm to use.

#### Usage

    BnlearnSearch$set_alg(method, args = NULL)

#### Arguments

- `method`:

  Character naming the algorithm to use.

- `args`:

  A list of additional arguments to pass to the algorithm.

------------------------------------------------------------------------

### Method [`set_knowledge()`](https://bjarkehautop.github.io/causalDisco/reference/set_knowledge.md)

Set the prior knowledge for the search algorithm using a knowledge
object.

#### Usage

    BnlearnSearch$set_knowledge(knowledge_obj)

#### Arguments

- `knowledge_obj`:

  A knowledge object containing prior knowledge.

------------------------------------------------------------------------

### Method `run_search()`

Run the search algorithm on the currently set data.

#### Usage

    BnlearnSearch$run_search(data = NULL)

#### Arguments

- `data`:

  A data frame containing the data to use for the search. If NULL, the
  currently set data will be used, i.e. `self$data`.

------------------------------------------------------------------------

### Method `clone()`

The objects of this class are cloneable with this method.

#### Usage

    BnlearnSearch$clone(deep = FALSE)

#### Arguments

- `deep`:

  Whether to make a deep clone.

## Examples

``` r
### bnlearn_search R6 class examples ###

# Generally, we do not recommend using the R6 classes directly, but rather
# use the disco() or any method function, for example pc(), instead.

# Load data
data("tpc_example")

# Recommended:
my_pc <- pc(engine = "bnlearn", test = "fisher_z", alpha = 0.05)
result <- my_pc(tpc_example)

# or
result <- disco(data = tpc_example, method = my_pc)

plot(result)


# Using R6 class:
s <- BnlearnSearch$new()

s$set_data(tpc_example)
s$set_test(method = "fisher_z", alpha = 0.05)
s$set_alg("pc")

g <- s$run_search()

plot(g)
```
